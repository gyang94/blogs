import{_ as a,c as n,o as i,ae as e}from"./chunks/framework.Bk39dawk.js";const l="/blogs/assets/streamhouse.BmwAWkEE.png",t="/blogs/assets/fluss-bucket.IJt7I47U.png",p="/blogs/assets/tiering-serivce-job.Bvs0LIlU.png",h="/blogs/assets/fluss-bucket-data.DvQCVcwr.png",m=JSON.parse('{"title":"Hands-on Fluss Lakehouse with Paimon S3","description":"","frontmatter":{"title":"Hands-on Fluss Lakehouse with Paimon S3","tags":"fluss","outline":"deep"},"headers":[],"relativePath":"notes/fluss/04-hands-on-fluss-lakehouse.md","filePath":"notes/fluss/04-hands-on-fluss-lakehouse.md","lastUpdated":1752924237000}'),o={name:"notes/fluss/04-hands-on-fluss-lakehouse.md"};function k(r,s,d,c,g,u){return i(),n("div",null,s[0]||(s[0]=[e('<h1 id="hands-on-fluss-lakehouse" tabindex="-1">Hands-on Fluss Lakehouse <a class="header-anchor" href="#hands-on-fluss-lakehouse" aria-label="Permalink to &quot;Hands-on Fluss Lakehouse&quot;">​</a></h1><p>Fluss persists historical data in a lakehouse storage layer while keeping real-time data in the Fluss server. A built-in tiering service continuously syncs fresh events into the lakehouse—enabling multiple query engines to run analytics over both hot and cold data. Fluss’s union-read feature then allows Flink jobs to transparently query from both the Fluss cluster and the lakehouse for seamless real-time processing.</p><p><img src="'+l+`" alt=""></p><p>In this tutorial, we’ll show you how to build a local Fluss lakehouse environment, perform essential data operations, and get hands-on experience with the end-to-end Fluss lakehouse architecture.</p><h2 id="integrate-paimon-s3-lakehouse" tabindex="-1">Integrate Paimon S3 Lakehouse <a class="header-anchor" href="#integrate-paimon-s3-lakehouse" aria-label="Permalink to &quot;Integrate Paimon S3 Lakehouse&quot;">​</a></h2><p>We’ll use <strong>Fluss 0.7</strong> and <strong>Flink 1.20</strong> to run the tiering service on a local cluster, with <strong>Paimon</strong> as the lake format and <strong>S3</strong> as paimon storage. Follow these steps:</p><h3 id="minio-setup" tabindex="-1">Minio Setup <a class="header-anchor" href="#minio-setup" aria-label="Permalink to &quot;Minio Setup&quot;">​</a></h3><ol><li>Install Minio object storage locally.</li></ol><p>Follow the official <a href="https://min.io/docs/minio/macos/index.html" target="_blank" rel="noreferrer">guide</a>.</p><ol start="2"><li>Start minio server</li></ol><p>Run this command with a local path to store minio data.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>minio server /tmp/minio-data</span></span></code></pre></div><ol start="3"><li>Verify in Minio WebUI.</li></ol><p>If minio server is successfully running, there will be several endpoints and an account shown:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>API: http://192.168.2.236:9000  http://127.0.0.1:9000</span></span>
<span class="line"><span>   RootUser: minioadmin</span></span>
<span class="line"><span>   RootPass: minioadmin</span></span>
<span class="line"><span></span></span>
<span class="line"><span>WebUI: http://192.168.2.236:61832 http://127.0.0.1:61832</span></span>
<span class="line"><span>   RootUser: minioadmin</span></span>
<span class="line"><span>   RootPass: minioadmin</span></span></code></pre></div><p>Open the webUI link and login with the user account.</p><ol start="4"><li>Create a <code>fluss</code> bucket through webUI.</li></ol><p><img src="`+t+`" alt=""></p><h3 id="fluss-cluster-setup" tabindex="-1">Fluss Cluster Setup <a class="header-anchor" href="#fluss-cluster-setup" aria-label="Permalink to &quot;Fluss Cluster Setup&quot;">​</a></h3><ol><li>Download Fluss</li></ol><p>Get the Fluss 0.7 binary release from the <a href="https://fluss.apache.org/downloads/" target="_blank" rel="noreferrer">Fluss official site</a>.</p><ol start="2"><li>Add Dependencies</li></ol><p>Download the <code>fluss-fs-s3-0.7.0.jar</code> from the <a href="https://fluss.apache.org/downloads/" target="_blank" rel="noreferrer">Fluss official site</a> and put it into <code>&lt;FLUSS_HOME&gt;/lib</code>.</p><p>Download the <code>paimon-s3-1.0.1.jar</code> from <a href="https://paimon.apache.org/docs/1.0/project/download/" target="_blank" rel="noreferrer">Paimon official site</a> and put it into <code>&lt;FLUSS_HOME&gt;/plugins/paimon</code>.</p><ol start="3"><li>Configure the Data Lake</li></ol><p>Edit <code>&lt;FLUSS_HOME&gt;/conf/server.yaml</code> and add:</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data.dir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tmp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fluss</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">remote.data.dir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tmp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fluss</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">remote</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">datalake.format</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> paimon</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">datalake.paimon.metastore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> filesystem</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">datalake.paimon.warehouse</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> s3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//fluss/data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">datalake.paimon.s3.endpoint</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//localhost:9000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">datalake.paimon.s3.access</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">key</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> minioadmin</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">datalake.paimon.s3.secret</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">key</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> minioadmin</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">datalake.paimon.s3.path.style.access</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span></code></pre></div><p>Set Paimon as the datalake format and s3 as the warehouse.</p><ol start="3"><li>Start Fluss</li></ol><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FLUSS_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">local</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cluster.sh start</span></span></code></pre></div><h3 id="flink-cluster-setup" tabindex="-1">Flink Cluster Setup <a class="header-anchor" href="#flink-cluster-setup" aria-label="Permalink to &quot;Flink Cluster Setup&quot;">​</a></h3><ol><li>Download Flink</li></ol><p>Grab the flink 1.20 binary package from the <a href="https://flink.apache.org/downloads/" target="_blank" rel="noreferrer">Flink downloads page</a>.</p><ol start="2"><li>Add the Fluss Connector</li></ol><p>Download <code>fluss-flink-1.20-0.7.0.jar</code> from the <a href="https://fluss.apache.org/downloads/" target="_blank" rel="noreferrer">Fluss official site</a> and copy it into:</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FLINK_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lib</span></span></code></pre></div><ol start="3"><li>Add Paimon Dependencies</li></ol><ul><li>Download <code>paimon-flink-1.20-1.0.1.jar</code> and <code>paimon-s3-1.0.1.jar</code> from the <a href="https://paimon.apache.org/docs/1.0/project/download/" target="_blank" rel="noreferrer">Paimon official site</a> into <code>&lt;FLINK_HOME&gt;/lib</code>.</li><li>Copy the Paimon plugin jars from Fluss into <code>&lt;FLINK_HOME&gt;/lib</code> .</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FLUSS_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plugins</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">paimon</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fluss</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lake</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">paimon</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.jar</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FLUSS_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plugins</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">paimon</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flink</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">shaded</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hadoop</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">uber</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.jar</span></span></code></pre></div><ol start="4"><li>Increase Task Slots</li></ol><p>Edit <code>&lt;FLINK_HOME&gt;/conf/config.yaml</code>:</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// e.g. increase the slots number to 5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">numberOfTaskSlots</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span></span></code></pre></div><ol start="5"><li>Start Flink</li></ol><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FLINK_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">start</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cluster.sh</span></span></code></pre></div><ol start="6"><li>Verify</li></ol><p>Open your browser to <code>http://localhost:8081/</code> and confirm the cluster is up.</p><h3 id="launching-the-tiering-service" tabindex="-1">Launching the Tiering Service <a class="header-anchor" href="#launching-the-tiering-service" aria-label="Permalink to &quot;Launching the Tiering Service&quot;">​</a></h3><ol><li>Get the Tiering Job Jar</li></ol><p>Download the <code>fluss-flink-tiering-0.7.0.jar</code> .</p><ol start="2"><li>Submit the Job</li></ol><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FLINK_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flink run \\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">path_to_jar</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fluss</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flink</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tiering</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.jar \\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fluss.bootstrap.servers localhost</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> \\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">datalake.format paimon \\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">datalake.paimon.metastore filesystem \\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">datalake.paimon.warehouse s3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//fluss/data \\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">datalake.paimon.s3.endpoint http</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//localhost:9000 \\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">datalake.paimon.s3.access</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">key minioadmin \\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">datalake.paimon.s3.secret</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">key minioadmin \\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">datalake.paimon.s3.path.style.access </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span></code></pre></div><ol start="3"><li>Confirm Deployment</li></ol><p>In the Flink UI, look for the <strong>Fluss Lake Tiering Service</strong> job. Once it’s running, your local tiering pipeline is operational.</p><p><img src="`+p+`" alt=""></p><h2 id="data-processing" tabindex="-1">Data Processing <a class="header-anchor" href="#data-processing" aria-label="Permalink to &quot;Data Processing&quot;">​</a></h2><p>In this section, we’ll use the Flink SQL Client to interact with our Fluss lakehouse and run both batch and streaming queries.</p><ol><li>Launch the SQL Client</li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>&lt;FLINK_HOME&gt;/bin/sql-client.sh</span></span></code></pre></div><ol start="2"><li>Create the Catalog and Table</li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CREATE CATALOG fluss_catalog WITH (</span></span>
<span class="line"><span>    &#39;type&#39; = &#39;fluss&#39;,   </span></span>
<span class="line"><span>    &#39;bootstrap.servers&#39; = &#39;localhost:9123&#39;</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>USE CATALOG fluss_catalog;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>CREATE TABLE t_user (</span></span>
<span class="line"><span>    \`id\` BIGINT,</span></span>
<span class="line"><span>    \`name\` string NOT NULL,</span></span>
<span class="line"><span>    \`age\` int,</span></span>
<span class="line"><span>    \`birth\` DATE,</span></span>
<span class="line"><span>    PRIMARY KEY (\`id\`) NOT ENFORCED</span></span>
<span class="line"><span>)WITH (</span></span>
<span class="line"><span>    &#39;table.datalake.enabled&#39; = &#39;true&#39;,</span></span>
<span class="line"><span>    &#39;table.datalake.freshness&#39; = &#39;30s&#39;</span></span>
<span class="line"><span>);</span></span></code></pre></div><ol start="3"><li>Write data</li></ol><p>Inserts two records.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>SET &#39;execution.runtime-mode&#39; = &#39;batch&#39;;</span></span>
<span class="line"><span>SET &#39;sql-client.execution.result-mode&#39; = &#39;tableau&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>INSERT INTO t_user(id,name,age,birth) VALUES</span></span>
<span class="line"><span>(1,&#39;Alice&#39;,18,DATE &#39;2000-06-10&#39;),</span></span>
<span class="line"><span>(2,&#39;Bob&#39;,20,DATE &#39;2001-06-20&#39;);</span></span></code></pre></div><ol start="4"><li>Union Read</li></ol><p>You can run a simple SQL query to get data from this table. By default, Flink will union data from both the Fluss cluster and the lakehouse:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span></span></span>
<span class="line"><span>Flink SQL&gt; select * from t_user;</span></span>
<span class="line"><span>+----+-------+-----+------------+</span></span>
<span class="line"><span>| id |  name | age |      birth |</span></span>
<span class="line"><span>+----+-------+-----+------------+</span></span>
<span class="line"><span>|  1 | Alice |  18 | 2000-06-10 |</span></span>
<span class="line"><span>|  2 |   Bob |  20 | 2001-06-20 |</span></span>
<span class="line"><span>+----+-------+-----+------------+</span></span></code></pre></div><p>Users can read data only from the lake table, by appending a <code>$lake</code> after the table name.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Flink SQL&gt; select * from t_user$lake;</span></span>
<span class="line"><span>+----+-------+-----+------------+----------+----------+----------------------------+</span></span>
<span class="line"><span>| id |  name | age |      birth | __bucket | __offset |                __timestamp |</span></span>
<span class="line"><span>+----+-------+-----+------------+----------+----------+----------------------------+</span></span>
<span class="line"><span>|  1 | Alice |  18 | 2000-06-10 |        0 |       -1 | 1970-01-01 07:59:59.999000 |</span></span>
<span class="line"><span>|  2 |   Bob |  20 | 2001-06-20 |        0 |       -1 | 1970-01-01 07:59:59.999000 |</span></span>
<span class="line"><span>+----+-------+-----+------------+----------+----------+----------------------------+</span></span></code></pre></div><p>The two records appear in data lake. The tiering service works for syncing data from Fluss to data lake.</p><p>Notice that in the paimon lake table, there are three system columns defined there: <code>__bucket</code>, <code>__offset</code> and <code>__timestamp</code> . The __bucket column shows which bucket this row in. The __offset and __timestamp columns are used for streaming mode data processing.</p><ol start="5"><li>Streaming Inserts</li></ol><p>Let’s switch to streaming mode and insert two new records.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Flink SQL&gt; SET &#39;execution.runtime-mode&#39; = &#39;streaming&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Flink SQL&gt; INSERT INTO t_user(id,name,age,birth) VALUES</span></span>
<span class="line"><span>(3,&#39;Catlin&#39;,25,DATE &#39;2002-06-10&#39;),</span></span>
<span class="line"><span>(4,&#39;Dylan&#39;,28,DATE &#39;2003-06-20&#39;);</span></span></code></pre></div><p>Query the lake:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span></span></span>
<span class="line"><span>Flink SQL&gt; select * from t_user$lake;</span></span>
<span class="line"><span>+----+----+--------+-----+------------+----------+----------+----------------------------+</span></span>
<span class="line"><span>| op | id |   name | age |      birth | __bucket | __offset |                __timestamp |</span></span>
<span class="line"><span>+----+----+--------+-----+------------+----------+----------+----------------------------+</span></span>
<span class="line"><span>| +I |  1 |  Alice |  18 | 2000-06-10 |        0 |       -1 | 1970-01-01 07:59:59.999000 |</span></span>
<span class="line"><span>| +I |  2 |    Bob |  20 | 2001-06-20 |        0 |       -1 | 1970-01-01 07:59:59.999000 |</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>Flink SQL&gt; select * from t_user$lake;</span></span>
<span class="line"><span>+----+----+--------+-----+------------+----------+----------+----------------------------+</span></span>
<span class="line"><span>| op | id |   name | age |      birth | __bucket | __offset |                __timestamp |</span></span>
<span class="line"><span>+----+----+--------+-----+------------+----------+----------+----------------------------+</span></span>
<span class="line"><span>| +I |  1 |  Alice |  18 | 2000-06-10 |        0 |       -1 | 1970-01-01 07:59:59.999000 |</span></span>
<span class="line"><span>| +I |  2 |    Bob |  20 | 2001-06-20 |        0 |       -1 | 1970-01-01 07:59:59.999000 |</span></span>
<span class="line"><span>| +I |  3 | Catlin |  25 | 2002-06-10 |        0 |        2 | 2025-07-19 19:03:54.150000 |</span></span>
<span class="line"><span>| +I |  4 |  Dylan |  28 | 2003-06-20 |        0 |        3 | 2025-07-19 19:03:54.150000 |</span></span></code></pre></div><p>At the first time, the two new records have not been synced into lake table. After waiting for a while they appear in the table.</p><p>The <code>__offset</code> and <code>__timestamp</code> columns for these two records are not the default values now. It shows the offset and timestamp when the records entered into the table.</p><ol start="6"><li>Inspect the Paimon Files</li></ol><p>Open the Minio webUI, you will see there exists paimon files in the bucket.</p><p><img src="`+h+`" alt=""></p><p>In your local filesystem, you can verify the Parquet files and manifest under <code>/tmp/minio-data</code> .</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/tmp/minio-data ❯ tree .</span></span>
<span class="line"><span>.</span></span>
<span class="line"><span>└── fluss</span></span>
<span class="line"><span>    └── data</span></span>
<span class="line"><span>        ├── default.db__XLDIR__</span></span>
<span class="line"><span>        │   └── xl.meta</span></span>
<span class="line"><span>        └── fluss.db</span></span>
<span class="line"><span>            └── t_user</span></span>
<span class="line"><span>                ├── bucket-0</span></span>
<span class="line"><span>                │   ├── changelog-1bafcc32-f88a-42a6-bc92-d3ccf4f62d4c-0.parquet</span></span>
<span class="line"><span>                │   │   └── xl.meta</span></span>
<span class="line"><span>                │   ├── changelog-f1853f1c-2588-4035-8233-e4804b1d8344-0.parquet</span></span>
<span class="line"><span>                │   │   └── xl.meta</span></span>
<span class="line"><span>                │   ├── data-1bafcc32-f88a-42a6-bc92-d3ccf4f62d4c-1.parquet</span></span>
<span class="line"><span>                │   │   └── xl.meta</span></span>
<span class="line"><span>                │   └── data-f1853f1c-2588-4035-8233-e4804b1d8344-1.parquet</span></span>
<span class="line"><span>                │       └── xl.meta</span></span>
<span class="line"><span>                ├── manifest</span></span>
<span class="line"><span>                │   ├── manifest-d554f475-ad8f-47e0-a83b-22bce4b233d6-0</span></span>
<span class="line"><span>                │   │   └── xl.meta</span></span>
<span class="line"><span>                │   ├── manifest-d554f475-ad8f-47e0-a83b-22bce4b233d6-1</span></span>
<span class="line"><span>                │   │   └── xl.meta</span></span>
<span class="line"><span>                │   ├── manifest-e7fbe5b1-a9e4-4647-a07a-5cc71950a5be-0</span></span>
<span class="line"><span>                │   │   └── xl.meta</span></span>
<span class="line"><span>                │   ├── manifest-e7fbe5b1-a9e4-4647-a07a-5cc71950a5be-1</span></span>
<span class="line"><span>                │   │   └── xl.meta</span></span>
<span class="line"><span>                │   ├── manifest-list-8975f7d7-9fec-4ac9-bb31-12be03d297d0-0</span></span>
<span class="line"><span>                │   │   └── xl.meta</span></span>
<span class="line"><span>                │   ├── manifest-list-8975f7d7-9fec-4ac9-bb31-12be03d297d0-1</span></span>
<span class="line"><span>                │   │   └── xl.meta</span></span>
<span class="line"><span>                │   ├── manifest-list-8975f7d7-9fec-4ac9-bb31-12be03d297d0-2</span></span>
<span class="line"><span>                │   │   └── xl.meta</span></span>
<span class="line"><span>                │   ├── manifest-list-bba1f130-e7ab-4f5e-8ce3-928a53524136-0</span></span>
<span class="line"><span>                │   │   └── xl.meta</span></span>
<span class="line"><span>                │   ├── manifest-list-bba1f130-e7ab-4f5e-8ce3-928a53524136-1</span></span>
<span class="line"><span>                │   │   └── xl.meta</span></span>
<span class="line"><span>                │   └── manifest-list-bba1f130-e7ab-4f5e-8ce3-928a53524136-2</span></span>
<span class="line"><span>                │       └── xl.meta</span></span>
<span class="line"><span>                ├── schema</span></span>
<span class="line"><span>                │   └── schema-0</span></span>
<span class="line"><span>                │       └── xl.meta</span></span>
<span class="line"><span>                └── snapshot</span></span>
<span class="line"><span>                    ├── LATEST</span></span>
<span class="line"><span>                    │   └── xl.meta</span></span>
<span class="line"><span>                    ├── snapshot-1</span></span>
<span class="line"><span>                    │   └── xl.meta</span></span>
<span class="line"><span>                    └── snapshot-2</span></span>
<span class="line"><span>                        └── xl.meta</span></span>
<span class="line"><span></span></span>
<span class="line"><span>28 directories, 19 files</span></span></code></pre></div><ol start="7"><li>View Snapshots</li></ol><p>Users can also check the snapshots from the system table, by appending <code>$lake$snapshots</code> after thefluss table name.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Flink SQL&gt; select * from t_user$lake$snapshots;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>+-------------+-----------+----------------------+-------------------------+-------------+----------+</span></span>
<span class="line"><span>| snapshot_id | schema_id |          commit_user |             commit_time | commit_kind | ...      |</span></span>
<span class="line"><span>+-------------+-----------+----------------------+-------------------------+-------------+----------+</span></span>
<span class="line"><span>|           1 |         0 | __fluss_lake_tiering | 2025-07-19 19:00:41.286 |      APPEND | ...      |</span></span>
<span class="line"><span>|           2 |         0 | __fluss_lake_tiering | 2025-07-19 19:04:38.964 |      APPEND | ...      |</span></span>
<span class="line"><span>+-------------+-----------+----------------------+-------------------------+-------------+----------+</span></span>
<span class="line"><span>2 rows in set (0.33 seconds)</span></span></code></pre></div><h2 id="summary" tabindex="-1">Summary <a class="header-anchor" href="#summary" aria-label="Permalink to &quot;Summary&quot;">​</a></h2><p>In this guide, we gave a concise overview of the Fluss lakehouse architecture, walked through a step-by-step local setup of both Fluss and Flink clusters, and showcased practical data-processing examples using real-time and historical data. Those steps give you practical experience with Fluss’s lakehouse architecture in a local environment.</p>`,87)]))}const y=a(o,[["render",k]]);export{m as __pageData,y as default};
